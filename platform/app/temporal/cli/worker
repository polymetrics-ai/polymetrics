#!/usr/bin/env ruby
# frozen_string_literal: true

require_relative "../../../config/application"
require "temporal/worker"

# Load the Rails environment
Rails.application.require_environment!

worker = Temporal::Worker.new

# Register workflows
worker.register_workflow(Temporal::Workflows::ConnectionDataSyncWorkflow)
worker.register_workflow(Temporal::Workflows::SyncWorkflow)

# Register activities
worker.register_activity(Temporal::Activities::StartSyncWorkflowsActivity)
worker.register_activity(Temporal::Activities::ExtractDataActivity)
worker.register_activity(Temporal::Activities::LogSyncErrorActivity)
worker.register_activity(Temporal::Activities::ConvertReadRecordActivity)
worker.start
